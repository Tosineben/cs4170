<!--
    Alden Quimby
    adq2101@columbia.edu
    describe the page here
    uses jquery
    uses bootstrap for ui components
    list any influences for design
 -->
<!DOCTYPE html>
<html lang="en">
    
    <head>
        <meta charset="utf-8">
        <title>Movie Reviews</title>
        <meta name="description" content="Awesome movie review site" />
        <meta name="author" content="Alden Quimby">

        <!-- stylesheets -->
        <link href="Styles/movies.css" type="text/css" rel="stylesheet" />
        <link href="Styles/bootstrap/bootstrap.min.css" type="text/css" rel="stylesheet" />
        <link href="Styles/bootstrap/bootstrap-responsive.min.css" type="text/css" rel="stylesheet" />

        <!-- use these when handing in , and move to bottom
            <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.1.min.js" type="text/javascript"></script>
            <script src="https://raw.github.com/janl/mustache.js/master/mustache.js" type="text/javascript"></script>
            <script src="https://raw.github.com/jonnyreeves/jquery-Mustache/master/src/jquery-Mustache.js" type="text/javascript"></script>
            <script src="https://raw.github.com/timrwood/moment/master/min/moment.min.js" type="text/javascript"></script>
            <script src="https://raw.github.com/documentcloud/underscore/master/underscore-min.js" type="text/javascript"></script>
            <script src="https://raw.github.com/twitter/bootstrap/master/docs/assets/js/bootstrap.min.js" type="text/javascript"></script>
            -->

        <!-- delete these before handing in -->
        <script src="Scripts/jquery-1.8.1.js"></script>
        <script src="Scripts/mustache.js"></script>
        <script src="Scripts/jquery-Mustache.js"></script>
        <script src="Scripts/moment.js"></script>
        <script src="Scripts/underscore.js"></script>
        <script src="Scripts/bootstrap.js" type="text/javascript"></script>
    </head>

    <body>

        <div class="navbar navbar-inverse navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="Index.html">Movie Reviews</a>
                    <div class="nav-collapse collapse">

                        <p class="navbar-text pull-right">
                            Super awesome movie reviews, by <a href="http://www.nytimes.com/pages/movies/index.html" target="_blank" class="navbar-link">NYT</a>
                        </p>

                        <ul class="nav">
                            <li class="active">
                                <a href="Index.html">Home</a>
                            </li>
                            <li>
                                <a href="Index.html">About</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" id="drop2" role="button" class="dropdown-toggle" data-toggle="dropdown">Dropdown 2 <b class="caret"></b></a>
                                <ul class="dropdown-menu" role="menu" aria-labelledby="drop2">
                                    <li><a tabindex="-1" href="#">Action</a></li>
                                    <li><a tabindex="-1" href="#">Another action</a></li>
                                    <li class="divider"></li>
                                    <li class="nav-header">Nav header</li>
                                    <li><a tabindex="-1" href="#">Separated link</a></li>
                                    <li class="dropdown-submenu">
                                        <a tabindex="-1" href="#">More options</a>
                                        <ul class="dropdown-menu">
                                            <li><a tabindex="-1" href="#">Cool Shit</a></li>
                                            <li><a tabindex="-1" href="#">Less Cool Shit</a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>

                        <form class="navbar-form">
                            <div class="input-prepend input-append">
                                <span class="add-on">
                                    <i class="icon-search"></i>
                                </span>
                                <input type="text" class="input-large search-query" id="navSearchQuery" placeholder="Search titles, genres, actors, etc.">
                                <button type="submit" class="btn" id="navSearchButton" onclick="return false;" data-loading-text="Searching...">Search</button>
                            </div>
                        </form>
                        
                    </div>
                </div>
            </div>
        </div>

        <div class="container-fluid" id="primaryContainer">
            <div class="row-fluid">
                <!--                <div class="span2">
                                        <div class="well sidebar-nav">
                                            <ul class="nav nav-list">
                                                <li class="nav-header">Sidebar</li>
                                                <li class="active"><a href="#">Link</a></li>
                                                <li><a href="#">Link</a></li>
                                                <li class="nav-header">Sidebar</li>
                                                <li><a href="#">Link</a></li>
                                                <li><a href="#">Link</a></li>
                                                <li class="nav-header">Sidebar</li>
                                                <li><a href="#">Link</a></li>
                                                <li><a href="#">Link</a></li>
                                            </ul>
                                        </div>
                                    </div>-->
                
                <!--                <div class="span2">
                                        <div class="row-fluid">
                                            <form class="form-horizontal">
                                                <legend>Crazy form</legend>
                                                <div class="control-group">
                                                    <label class="control-label" for="inputEmail">Email</label>
                                                    <div class="controls">
                                                        <div class="input-prepend">
                                                            <span class="add-on">
                                                                <i class="icon-envelope"></i>
                                                            </span>
                                                            <input class="input-medium" id="inputEmail" type="text" placeholder="Enter your email address">
                                                        </div>
                                                        <span class="help-inline">Must have @ symbol dood</span>
                                                    </div>
                                                </div>
                                                <div class="control-group">
                                                    <label class="control-label" for="inputGenre">Genre</label>
                                                    <div class="controls">
                                                        <select class="span2" id="inputGenre">
                                                            <option>Comedy</option>
                                                            <option>Horror</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="control-group">
                                                    <div class="controls">
                                                        <label class="checkbox">
                                                            <input type="checkbox">
                                                            Remember me
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="form-actions">
                                                    <button type="submit" class="btn btn-primary">Do It Up</button>
                                                    <button type="button" class="btn">Cancel</button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>-->

                <div class="span12">
                    <div class="hero-unit" id="primaryMovie" style="display:none;">
                        <h1>Hello, world!</h1>
                        <p class="movie-description">This is a template for a simple marketing or informational website. It includes a large callout called the hero unit and three supporting pieces of content. Use it as a starting point to create something more unique.</p>
                        <p><a class="btn btn-primary btn-large">Learn more »</a></p>
                    </div>
                </div>
            </div>
            <hr id="movie-list-separator">
            <div class="row-fluid">
                <div class="span12" id="movie-list"></div>
            </div>
            <div class="row-fluid">
                <div class="pagination pagination-centered">
                    <ul id="pagination-list"></ul>
                </div>
            </div>

            <hr>

            <footer>
                <p>© Sept 2012 - Alden Quimby</p>
            </footer>

        </div>

        <!-- scripts -->
        <!-- at bottom so page loads quick -->
        
        <script src="Scripts/adq.module.js" type="text/javascript"></script>
        <script src="Scripts/movies.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            
            (function () {

                $(function () {
                    
                    $.Mustache.addFromDom();

                    var baseUrl = 'http://api.nytimes.com/svc/movies/v2';
                    var apiKey = 'bd2994d7e713ac0c7c58f238661910bb:19:64484326';

                    var settings = {
                        getSearchUrl: function (query, offset, criticsPick, thousandBest, dvd, reviewer, pubDate, openDate) {
                            var url = baseUrl + '/reviews/search?api-key=' + apiKey + '&query=' + query;
                            
                            if (offset) {
                                url += "&offset=" + offset;
                            }
                            if (criticsPick) {
                                url += "&critics-pick=" + criticsPick;
                            }
                            if (thousandBest) {
                                url += "&thousand-best=" + thousandBest;
                            }
                            if (dvd) {
                                url += "&dvd=" + dvd;
                            }
                            if (reviewer) {
                                url += "&reviewer=" + reviewer;
                            }
                            if (pubDate) {
                                url += "&publication-date=" + pubDate;
                            }
                            if (openDate) {
                                url += "&opening-date=" + openDate;
                            }

                            return url;
                        },
                        getBioUrl: function (reviewerName) {
                            var nameForUrl = reviewerName.replace(/ /g, '-').replace(/\./g, '');
                            return baseUrl + '/critics/' + nameForUrl + '?api-key=' + apiKey;
                        },
                    };

                    adq.module('movieReviews').search.init(settings);
                    
                });

            })();

        </script>

    </body>

</html>

<!-- foreach page, add to list as either disabled, active or regular -->
<script id="page-numbers" type="text/html">
    {{#pages}}
        {{#disabled}}
            <li class="disabled"><span>{{& numDisplay}}</span></li>
        {{/disabled}}
        {{^disabled}}
        {{#active}}
            <li class="active"><span>{{& numDisplay}}</span></li>
        {{/active}}
        {{^active}}
            <li><a href="#" class="page-number" data-offset="{{offset}}" onclick="return false;">{{& numDisplay}}</a></li>
        {{/active}}
        {{/disabled}}
    {{/pages}}
</script>

<script id="movie-row" type="text/html">
    <div class="row-fluid" style="padding-bottom:10px;">
        {{#movies}}
        <div class="span3">
            <div class="well">
                <h4>{{& title}}</h4>
                <img src="{{imgSrc}}" alt="" class="pull-left" style="padding-right:10px;" />
                <div>
                    <p><small>
                           <strong>{{& headline}}.</strong>
                           <!--<span class="summary"> {{& summary}}</span>-->
                       </small></p>
                    <p>
                        <a href="#movie-detail-{{movieId}}" role="button" class="btn" data-toggle="modal">View details »</a>
                    </p>
                </div>
            </div>
        </div>
        <div class="modal hide fade" id="movie-detail-{{movieId}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div id="movie-detail-modal-{{movieId}}">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h3>{{& title}}</h3>
                </div>
                <div class="modal-body">

                    <img src="{{imgSrc}}" alt="" class="pull-left" style="padding-right: 10px;" />

                    <small>{{#relatedUrls}}
                        <p><a href="{{url}}">{{suggested_link_text}}</a></p>
                        {{/relatedUrls}}
                
                        <p>Reviewed by {{reviewerName}} on {{reviewPubDate}}</p>
                        <p>Read the full NYT review <a href="{{reviewUrl}}">here</a></p>

                        {{#isThousandBest}}
                        <p>Thousan best!</p>
                        {{/isThousandBest}}

                        {{#isCriticsPick}}
                        <p>Critics Pick!</p>
                        {{/isCriticsPick}}
                
                        {{#headline}}
                        <p><strong>{{& headline}}.</strong>{{& summary}}</p>
                        {{/headline}}

                        <p>{{reviewSnippet}}</p>

                    </small>
                </div>
                <div class="modal-footer" style="max-height: 120px; overflow-y: auto;">
                    <div id="reviewer-bio-modal-{{movieId}}">
                        <p>Learn more about <a href="#" class="reviewer-bio" data-id="{{movieId}}">{{reviewerName}}</a></p>
                    </div>
                </div>
            </div>
            <div id=""></div>
        </div>
        {{/movies}}            
    </div>
</script>

<script id="biography" type="text/html">
    <h5>{{& reviewerName}}</h5>
    <p>{{& bioText}}</p>
</script>

<script id="alert" type="text/html">
    <div class="alert alert-error fade in">
        <button type="button" class="close" data-dismiss="alert">×</button>
        <strong>Oops!</strong> {{message}}
    </div>
</script>